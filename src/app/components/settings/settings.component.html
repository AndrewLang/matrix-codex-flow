<section class="flex h-full min-h-0 flex-col gap-4 overflow-y-auto p-3 text-slate-200">
    <mtx-workspace-header title="Settings"
        description="Configure agent behavior, prompt template, and project generation flags."
        [rightCommands]="headerRightCommands()"></mtx-workspace-header>

    <div class="grid gap-4">
        <article class="rounded-2xl bg-slate-900/60 p-5 backdrop-blur ">
            <h2 class="text-base font-semibold text-slate-100">Agent Setting</h2>
            <p class="mt-1 text-sm text-slate-400">Choose the agent provider used by the VibeFlow.</p>

            <label class="mt-4 block text-sm text-slate-300" for="agent-provider">Provider</label>
            <div class="relative mt-2">
                <select #agentProviderInput id="agent-provider"
                    class="w-full appearance-none rounded-xl bg-slate-800/80 px-3 py-2 pr-12 text-sm text-slate-100 outline-none ring-0 shadow-inner shadow-slate-950/50"
                    [value]="agentProvider()" (change)="setAgentProvider(agentProviderInput.value)">
                    <option value="codex">Codex</option>
                </select>
                <span class="pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-xs text-slate-400">
                    &#9662;
                </span>
            </div>

            @if (agentProvider() === 'codex') {
            <label class="mt-4 block text-sm text-slate-300" for="codex-api-key">Codex API Key</label>
            <input #codexApiKeyInput id="codex-api-key" type="password" autocomplete="off"
                class="mt-2 w-full rounded-xl bg-slate-800/80 px-3 py-2 text-sm text-slate-100 outline-none ring-0 shadow-inner shadow-slate-950/50"
                [value]="codexApiKey()" (input)="setCodexApiKey(codexApiKeyInput.value)"
                placeholder="Enter Codex API key" />

            <label class="mt-4 block text-sm text-slate-300" for="agent-model">Model</label>
            <input #agentModelInput id="agent-model" type="text" autocomplete="off"
                class="mt-2 w-full rounded-xl bg-slate-800/80 px-3 py-2 text-sm text-slate-100 outline-none ring-0 shadow-inner shadow-slate-950/50"
                [value]="agentModel()" (input)="setAgentModel(agentModelInput.value)" placeholder="gpt-5-codex" />
            <p class="mt-2 text-xs text-slate-500">Stored in app settings and used for Codex agent requests.</p>
            }
        </article>

        <article class="rounded-2xl bg-slate-900/60 p-5 backdrop-blur ">
            <h2 class="text-base font-semibold text-slate-100">Prompt Template</h2>
            <p class="mt-1 text-sm text-slate-400">Define the base instruction template injected into agent prompts.</p>

            <div class="mt-4 rounded-2xl bg-slate-800/50">
                <mtx-md-editor [value]="promptTemplate()" placeholder="Enter prompt template" background="#020617"
                    (valueChange)="setPromptTemplate($event)"></mtx-md-editor>
            </div>
        </article>

        <article class="rounded-2xl bg-slate-900/60 p-5 backdrop-blur ">
            <h2 class="text-base font-semibold text-slate-100">Project Context</h2>
            <p class="mt-1 text-sm text-slate-400">Control whether VibeFlow generates a local <code>./vibeflow</code>
                folder in the project directory.</p>

            <label class="mt-4 flex items-center justify-between gap-3 rounded-xl bg-slate-800/60 px-3 py-2">
                <span class="text-sm text-slate-200">Generate <code>./vibeflow</code> folder</span>
                <button type="button" role="switch" [attr.aria-checked]="generateVibeflowFolder()"
                    class="relative h-7 w-12 rounded-full transition-colors duration-200"
                    [class.bg-emerald-500]="generateVibeflowFolder()" [class.bg-slate-600]="!generateVibeflowFolder()"
                    (click)="setGenerateVibeflowFolder(!generateVibeflowFolder())">
                    <span
                        class="absolute left-1 top-1 h-5 w-5 rounded-full bg-white shadow transition-transform duration-200"
                        [class.translate-x-5]="generateVibeflowFolder()"
                        [class.translate-x-0]="!generateVibeflowFolder()"></span>
                </button>
            </label>
        </article>
    </div>
</section>
